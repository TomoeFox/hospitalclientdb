//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit3.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm3 *Form3;
//---------------------------------------------------------------------------
__fastcall TForm3::TForm3(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TForm3::Button1Click(TObject *Sender)
{
ADOQuery1->Close();
//ADOQuery1->Parameters->ParamByName("par0")->Value=Edit1->Text; //Фамилия врача
//ADOQuery1->Parameters->ParamByName("par1")->Value=Edit2->Text;   //Пациента Ф.И.О.
//ADOQuery1->Parameters->ParamByName("par2")->Value=Edit3->Text;   //год
//ADOQuery1->Parameters->ParamByName("par3")->Value=Edit4->Text; //адресс */
/*if (Edit1->Text.IsEmpty()==true || Edit1->Text == " " || Edit1->Text == " ") {

ADOQuery1->SQL->Text="select * from patients WHERE PatName = :par1 AND Address = :par3 AND Year = :par2;";
ADOQuery1->Parameters->ParamByName("par1")->Value=Edit2->Text;
ADOQuery1->Parameters->ParamByName("par2")->Value=Edit3->Text;
ADOQuery1->Parameters->ParamByName("par3")->Value=Edit4->Text;
ADOQuery1->ExecSQL();
}
else if (Edit2->Text.IsEmpty()==true || Edit2->Text == " " || Edit2->Text == " ") {

 ADOQuery1->SQL->Text="select * from patients WHERE DocName = :par0 AND Address = :par3 AND Year = :par2;";
ADOQuery1->Parameters->ParamByName("par0")->Value=Edit1->Text;
ADOQuery1->Parameters->ParamByName("par2")->Value=Edit3->Text;
ADOQuery1->Parameters->ParamByName("par3")->Value=Edit4->Text;

 ADOQuery1->ExecSQL();
}
else if (Edit3->Text.IsEmpty()==true || Edit3->Text == " " || Edit3->Text == " ") {

 ADOQuery1->SQL->Text="select * from patients WHERE DocName = :par0 AND Address = :par3 AND PatName = :par1;";
 ADOQuery1->Parameters->ParamByName("par0")->Value=Edit1->Text;
ADOQuery1->Parameters->ParamByName("par1")->Value=Edit2->Text;
ADOQuery1->Parameters->ParamByName("par3")->Value=Edit4->Text;
 ADOQuery1->ExecSQL();
}
else {

ADOQuery1->SQL->Text="select * from patients WHERE DocName = :par0 AND Address = :par3 AND PatName = :par1 AND Year = :par2;";
ADOQuery1->Parameters->ParamByName("par0")->Value=Edit1->Text;
ADOQuery1->Parameters->ParamByName("par1")->Value=Edit2->Text;
ADOQuery1->Parameters->ParamByName("par2")->Value=Edit3->Text;
ADOQuery1->Parameters->ParamByName("par3")->Value=Edit4->Text;
ADOQuery1->ExecSQL();
}    */

ADOQuery1->SQL->Text="select * from patients WHERE PatName = :par1 AND Address = :par3 AND Year = :par2;";
AnsiString PatName =(Edit2->Text);
AnsiString Address=(Edit4->Text);
AnsiString Year = (Edit3->Text)
const char * address = Address.c_str();
int year = Year.ToInt();
ADOQuery1->Parameters->ParamByName("par1")->Value=pat;
ADOQuery1->Parameters->ParamByName("par2")->Value=year;
ADOQuery1->Parameters->ParamByName("par3")->Value=address;

ADOQuery1->ExecSQL();
ADOQuery1->Open();
}
//---------------------------------------------------------------------------

void __fastcall TForm3::FormCreate(TObject *Sender)
{
Label4->Hide();
Label5->Hide();
Label3->Hide();
Label8->Hide();
Edit1->Hide();
Edit2->Hide();
Edit3->Hide();
Edit4->Hide();
Label9->Font->Color=clRed;
}
//---------------------------------------------------------------------------

void __fastcall TForm3::Button4Click(TObject *Sender)
{
  if(Button4->Caption == "Показать формы"){
  Label3->Show();
Label4->Show();
Label5->Show();
Label8->Show();
Edit1->Show();
Edit2->Show();
Edit3->Show();
Edit4->Show();
Button4->Caption = "Скрыть формы" ;
 }
 else if (Button4->Caption == "Скрыть формы") {
Label4->Hide();
Label5->Hide();
Label3->Hide();
Label8->Hide();
Edit1->Hide();
Edit2->Hide();
Edit3->Hide();
Edit4->Hide();
Button4->Caption = "Показать формы";
	  }
}
//---------------------------------------------------------------------------


void __fastcall TForm3::ADOConnection1AfterConnect(TObject *Sender)
{
Label9->Font->Color=clGreen;
ShowMessage("Подключенно");
Button5->Caption = "Отключение";
}
//---------------------------------------------------------------------------

void __fastcall TForm3::Button5Click(TObject *Sender)
{
if(Button5->Caption == "Подключение") {
ADOConnection1->Open();
Button5->Caption = "Отключение" ;
}
else if (Button5->Caption == "Отключение") {
  ADOConnection1->Close();
  Button5->Caption = "Подключение";
	 }
}
//---------------------------------------------------------------------------

void __fastcall TForm3::ADOConnection1AfterDisconnect(TObject *Sender)
{
Label9->Font->Color=clRed;
ShowMessage("Отключенно");
  Button5->Caption = "Подключение";
}
//---------------------------------------------------------------------------


void __fastcall TForm3::FormClose(TObject *Sender, TCloseAction &Action)
{
  ADOConnection1->Close();
}
//---------------------------------------------------------------------------

